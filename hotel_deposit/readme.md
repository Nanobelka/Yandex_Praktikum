# [Модель, прогнозирующая отказ от брони в отеле](https://github.com/Nanobelka/Yandex_Praktikum/blob/main/hotel_deposit/hotel_deposit.ipynb)
## На основании ряда характеристик заказа создать систему, предсказывающую отказ от заказа

**Заказчик:** сеть отелей.

**Входные данные:** информация с характеристиками заказов.

**Цель проекта:** разработать систему, предсказывающую отказ от брони (заказа): если модель покажет, что бронь будет отменена, клиенту предложат внести депозит? который пойдет в прибыль отеля, если клиент отменит бронь.

**Задачи проекта:** 

- провести исследовательский анализ данных;
- оценить прибыль отеля до внедрения депозитов;
- выбрать метрику для обучения моделей;
- обучить разные модели и оценить их качество кросс-валидацией;
- выбрать лучшую модель и проверить ее на тестовой выборке;
- оценить прибыль, которую принесет выбранная модель;
- на основе исследовательского анализа выявить признаки клиента, склонного к отмене заказа;
- дать рекомендации по дальнейшему развитию данного проекта.


## Содержание

0  Начальная подготовка

    0.1  Импорты
    0.2  Константы
    0.3  Вспомогательные функции
    0.4  Оформление

1  Чтение и проверка входных данных

    1.1  Чтение данных
    1.2  Первичная информация о данных
    1.3  Проверка на дубликаты
    1.4  Удаление ненужных полей
    1.5  Заполнение пропусков
    1.6  Корректировка типов данных
    1.7  Распределение признаков с учетом Exited
        1.7.1  Графики распределений
        1.7.2  Статистики распределений
        1.7.3  Попарные распределения признаков
    1.8  Корреляция
        1.8.1  Корреляция признаков с целевой переменной
        1.8.2  Корреляция признаков между собой
    1.9  Сбалансированность классов

2  Подготовка данных для моделей

    2.1  Выделение признаков и целевой переменной
    2.2  Разделение на обучающую и тестовую выборки
    2.3  Препроцессинг
        2.3.1  Подготовка признаков для пайплайна модели

3  Модели без учета дисбаланса классов

    3.1  Пайплайны моделей
    3.2  Сетки гиперпараметров
    3.3  Объединение всех данных о моделях в датафрейм
    3.4  OptunaSearchCV: cоздание и обучение
    3.5  Визуализация результатов подбора гиперпараметров
    3.6  Функция для сбора итоговой таблицы
    3.7  Сравнение моделей

4  Модели с балансировкой классов

    4.1  Балансировка классов
    4.2  Пайплайны моделей
    4.3  Объединение всех данных о моделях в датафрейм
    4.4  OptunaSearchCV: cоздание и обучение
    4.5  Визуализация результатов подбора гиперпараметров
    4.6  Сравнение моделей

5  Финальная модель HistGradientBoostingClassifier

    5.1  Пайплайн модели
    5.2  Сетка гиперпараметров
    5.3  Объединение всех данных о моделях в датафрейм
    5.4  OptunaSearchCV: cоздание и обучение
    5.5  Визуализация результатов подбора гиперпараметров
    5.6  Характеристики финальной модели
    5.7  Важность признаков
        5.7.1  Функция для визуализации важности признаков
        5.7.2  Важность признаков для обучающей выборки
        5.7.3  Важность признаков для тестовой выборки

6  Вывод

    6.1  Краткий обзор проведенной работы
    6.2  Результаты анализа
        6.2.1  Чтение и проверка входных данных
        6.2.2  Подготовка данных для моделей
        6.2.3  Обучение моделей
        6.2.4  Финальная модель
    6.3  Рекомендации и риски
