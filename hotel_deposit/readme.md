# [Модель, прогнозирующая отказ от брони в отеле](https://github.com/Nanobelka/Yandex_Praktikum/blob/main/hotel_deposit/hotel_deposit.ipynb)
## На основании ряда характеристик заказа создать систему, предсказывающую отказ от заказа

**Заказчик:** сеть отелей.

**Входные данные:** информация с характеристиками заказов.

**Цель проекта:** разработать систему, предсказывающую отказ от брони (заказа): если модель покажет, что бронь будет отменена, клиенту предложат внести депозит, который пойдет в прибыль отеля в случае отмены заказа.

**Задачи проекта:** 

- провести исследовательский анализ данных;
- оценить прибыль отеля до внедрения депозитов;
- выбрать метрику для обучения моделей;
- обучить разные модели и оценить их качество кросс-валидацией;
- выбрать лучшую модель и проверить ее на тестовой выборке;
- оценить прибыль, которую принесет выбранная модель;
- на основе исследовательского анализа выявить признаки клиента, склонного к отмене заказа;
- дать рекомендации по дальнейшему развитию данного проекта.


## Содержание

0  Начальная подготовка

    0.1  Импорты
    0.2  Константы
    0.3  Вспомогательные функции
    0.4  Оформление

1  Чтение и проверка входных данных

    1.1  Чтение данных
    1.2  Первичная информация о данных
    1.3  Проверка на дубликаты
    1.4  Удаление ненужных полей
    1.5  Проверка и правка значений

2  Исследовательский анализ

    2.1  Сбалансированность датасета по целевому признаку
    2.2  Распределение признаков с учетом is_canceled
        2.2.1  Графики распределений признаков типа object
        2.2.2  Графики распределений числовых признаков
    2.3  Исследование признаков — кандидатов на преобразование в бинарные или удаление
    2.4  Исследование признака country

3  Создание новых признаков

    3.1  Бинарные признаки
    3.2  Базовая стоимость аренды комнаты
    3.3  Сезонная стоимость аренды комнаты
    3.4  Стоимость подготовки / уборки комнаты

4  Прибыль до внедрения депозитов

5  Корреляция

    5.1  Корреляция признаков с целевой переменной
    5.2  Корреляция признаков между собой

6  Разработка модели ML

    6.1  Выбор метрики для оптимизации моделей
    6.2  Выделение признаков и целевой переменной
    6.3  Препроцессинг
    6.4  Пайплайны моделей
    6.5  Объединение всех данных о моделях в датафрейм
    6.6  Objective function для Optuna
    6.7  Подбор гиперпараметров
    6.8  Визуализация результатов подбора гиперпараметров
    6.9  Лучшая модель
    6.10  Функция для сравнения дополнительных метрик
    6.11  Сравнение моделей
    6.12  Важность признаков
        6.12.1  Функция для визуализации важности признаков
        6.12.2  Важность признаков для обучающей выборки
        6.12.3  Важность признаков для тестовой выборки

7  Прибыль от внедрения модели

8  Признаки клиента, повышающие вероятность отмены заказа

9  Вывод

    9.1  Краткий обзор проведенной работы
    9.2  Основная часть
        9.2.1  Исследовательский анализ
        9.2.2  Прибыль
        9.2.3  Подготовка данных для моделей
        9.2.4  Обучение моделей и выбор лучшей.
        9.2.5  Финальная модель
        9.2.6  Прибыль
    9.3  Рекомендации и риски
